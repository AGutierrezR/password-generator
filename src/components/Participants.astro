---
import { readdir } from 'node:fs/promises'

const { showAll = false } = Astro.props

const MAX_ITEMS = 12

async function getParticipants() {
	const entries = await readdir(new URL('../pages/entry', import.meta.url), { withFileTypes: true })
	return entries
		.filter((dirent) => dirent.isDirectory())
		.map((dirent) => dirent.name)
		.sort(new Intl.Collator('es').compare)
}

const participants = await getParticipants()

const shownParticipants = showAll ? participants : participants.slice(0, MAX_ITEMS)
---

<h2 class='text-giga font-bold font-special uppercase text-3xl mb-4'>Participaciones</h2>
<ul class='flex flex-wrap gap-7 justify-center'>
	{
		shownParticipants.map((name) => (
			<li class='inline-flex flex-shrink-0'>
				<a
					class='text-white hover:underline text-center flex flex-col gap-y-2'
					href={'/entry/' + name}
				>
					<img
						class='rounded-full w-20 h-20'
						src={'https://unavatar.io/github/' + name}
						alt={name}
					/>
					<span class='block'>{name}</span>
				</a>
			</li>
		))
	}
</ul>
{
	participants.length > shownParticipants.length ? (
		<div class='mt-2'>
			<a href='/entry' class='text-violet-500 hover:underline'>
				Ver m√°s...
			</a>
		</div>
	) : null
}
